<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Intranet Feuerwehr Wiener Neustadt</title>
  <!-- FontAwesome für Icons -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
  />
  <!-- Papa Parse für CSV-Verarbeitung -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>

  <style>
    /* -----------------------------------------
       ALLGEMEINE SEITEN-STYLES (DARK MODE)
       ----------------------------------------- */
    body {
      font-family: Arial, Helvetica, sans-serif;
      background-color: #212121;
      color: #f0f0f0;
      margin: 0;
      padding: 0;
    }
    .main-container {
      width: calc(100% - 40px);
      max-width: 1050px;
      margin: 20px auto;
    }
    .unified-container {
      background-color: #2a2a2a;
      border-radius: 8px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.7);
      padding: 20px;
    }

    /* -----------------------------------------
       HEADER: Zeit & Ticker
       ----------------------------------------- */
    .header {
      margin-bottom: 20px;
    }
    .time-display {
      background-color: #AB2328;
      color: #ffffff;
      padding: 5px;
      border-radius: 8px;
      font-size: 1.2em;
      margin-bottom: 5px;
      text-align: center;
      font-weight: bold;
    }
    #currentDateTime {
      text-align: center;
    }
    /* Ticker */
    .ticker-container {
      position: relative;
      width: 98%;
      overflow: hidden;
      background-color: #444;
      border-radius: 8px;
      padding: 10px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      margin-top: 10px;
    }
    .ticker {
      display: inline-block;
      white-space: nowrap;
      animation: ticker 45s linear infinite;
      font-size: 1em;
    }
    @keyframes ticker {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }
    .ticker-item {
      display: inline-block;
      margin-right: 50px;
    }
    .ticker-item i {
      margin-right: 5px;
    }

    /* -----------------------------------------
       BUTTON-GRID
       ----------------------------------------- */
    .button-grid-container {
      display: flex;
      align-items: flex-start;
      justify-content: center;
      margin-bottom: 20px;
    }
    /* Linke 2x2-Kacheln */
    .left-grid {
      display: grid;
      grid-template-columns: repeat(2, 235px);
      grid-template-rows: repeat(2, 235px);
      gap: 20px;
    }
    .left-button {
      background-color: #b32428;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-decoration: none;
      color: white;
      font-size: 24px;
      font-weight: bold;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: transform 0.2s;
      text-align: center;
      padding: 10px;
    }
    .left-button:hover {
      transform: scale(1.05);
    }
    .left-button i {
      font-size: 48px;
      margin-bottom: 10px;
    }
    .button-text {
      font-size: 18px;
      font-weight: bold;
      color: white;
    }

    /* Rechte 3x3-Kacheln */
    .right-grid {
      display: grid;
      grid-template-columns: repeat(3, 150px);
      grid-template-rows: repeat(3, 150px);
      gap: 20px;
      margin-left: 20px;
    }
    .button {
      background-color: #b32428;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-decoration: none;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: transform 0.2s;
      text-align: center;
    }
    .button:hover {
      transform: scale(1.05);
    }
    .button i {
      font-size: 48px;
      color: white;
      margin-bottom: 10px;
    }
    .button .button-text {
      font-size: 16px;
      font-weight: bold;
      color: white;
    }

    /* Ausgrauen/Deaktivieren (z.B. für Fahrtenbuch) */
    .disabled {
      opacity: 0.5;
      pointer-events: none; /* Keine Klicks möglich */
    }

    /* Platzhalter-Stil (für die letzten 4 Kacheln rechts) */
    .placeholder i {
      font-size: 36px;
      color: #999;
    }
    .placeholder .button-text {
      color: #999;
    }

    /* -----------------------------------------
       EINSATZBERICHTE (Tabelle)
       ----------------------------------------- */
    .einsatzberichte-container {
      margin: 20px 0;
      margin-bottom: 50px;
    }
    .einsatzberichte-container h1 {
      font-size: 1.5em;
      color: #777;
      text-align: center;
      margin-bottom: 20px;
    }
    .einsatzberichte-container table {
      border-collapse: collapse;
      width: 100%;
      background-color: #2a2a2a;
      box-shadow: 0 2px 5px rgba(0,0,0,0.7);
      border-radius: 8px;
      overflow: hidden;
    }
    .einsatzberichte-container th,
    .einsatzberichte-container td {
      padding: 10px;
      border: 1px solid #444;
      text-align: left;
    }
    .einsatzberichte-container th {
      background-color: #3a3a3a;
      color: #f0f0f0;
    }
    .einsatzberichte-container tr:nth-child(even) {
      background-color: #333;
    }
    .einsatzberichte-container tr:nth-child(odd) {
      background-color: #2a2a2a;
    }

    /* -----------------------------------------
       KALENDER (DARK MODE)
       ----------------------------------------- */
    .calendar-container {
      margin-top: 50px;
      padding: 20px;
      background-color: #2a2a2a;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.7);
      position: relative;
    }
    /* Kopfzeile */
    .calendar-header-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background-color: #3a3a3a;
      padding: 8px 16px;
      border-radius: 6px;
      margin-bottom: 10px;
    }
    .calendar-header-left, .calendar-header-right {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .calendar-btn {
      background-color: #3a3a3a;
      border: 1px solid #555;
      border-radius: 4px;
      padding: 6px 10px;
      cursor: pointer;
      color: #f0f0f0;
      font-size: 14px;
    }
    .calendar-btn:hover {
      background-color: #4a4a4a;
    }
    .calendar-nav-arrows button {
      background-color: #3a3a3a;
      border: none;
      cursor: pointer;
      font-size: 18px;
      margin: 0 4px;
      color: #f0f0f0;
    }
    .calendar-nav-arrows button:hover {
      background-color: #4a4a4a;
      border-radius: 4px;
    }
    .calendar-month-year {
      font-weight: 500;
      font-size: 16px;
      color: #f0f0f0;
      min-width: 110px;
      text-align: center;
    }
    /* Wochentage */
    .weekdays {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      background-color: #3a3a3a;
      border-radius: 6px;
      margin-bottom: 8px;
    }
    .weekdays div {
      text-align: center;
      font-weight: 500;
      padding: 10px 0;
      color: #f0f0f0;
      font-size: 14px;
      border-right: 1px solid #444;
    }
    .weekdays div:last-child {
      border-right: none;
    }
    /* Tages-Grid */
    .days {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
    }
    .day-cell {
      border: 1px solid #444;
      min-height: 80px;
      padding: 6px;
      position: relative;
      font-size: 14px;
      background-color: #2a2a2a;
      color: #f0f0f0;
    }
    .day-number {
      font-weight: 600;
      margin-bottom: 4px;
    }
    .today-highlight {
      border: 2px solid #AB2328;
      border-radius: 4px;
      padding: 4px;
    }
    .event {
      background-color: #AB2328;
      margin: 3px 0;
      padding: 2px 4px;
      border-radius: 3px;
      font-size: 13px;
      color: #f0f0f0;
      cursor: pointer;
      max-width: 95%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      position: relative;
    }
    .event:hover {
      background-color: #c13a3f;
    }
    .empty {
      background-color: #333;
      color: #999;
    }

    .footer {
  text-align: center;
  background-color: #3a3a3a;
  color: #f0f0f0;
  padding: 10px;
  margin-top: 20px;
  /* Falls du einen "sticky Footer" möchtest, der immer unten bleibt: */
  /* position: fixed;
     bottom: 0;
     width: 100%; */
}


    /* -----------------------------------------
       POPUP ("Pin") FÜR EVENT-DETAILS DIREKT IN DER ZELLE
       ----------------------------------------- */
    .event-popup {
      position: absolute;
      top: 100%;
      left: 0;
      background-color: #333;
      border: 1px solid #444;
      border-radius: 4px;
      padding: 8px;
      z-index: 10;
      width: 90%;
      box-shadow: 0 2px 5px rgba(0,0,0,0.7);
    }
    .event-popup .close-popup {
      position: absolute;
      top: 2px;
      right: 4px;
      cursor: pointer;
      font-size: 16px;
      color: #f0f0f0;
    }
    .event-popup p {
      margin: 4px 0;
      font-size: 13px;
    }

    /* -----------------------------------------
       RESPONSIVE DESIGN (gekürzt)
       ----------------------------------------- */
    @media (max-width: 1024px) {
      .button-grid-container {
        flex-direction: column;
        align-items: center;
      }
      .left-grid {
        grid-template-columns: 1fr 1fr;
      }
      .right-grid {
        grid-template-columns: 1fr 1fr 1fr;
        margin-left: 0;
        margin-top: 20px;
      }
    }
    @media (max-width: 768px) {
      .left-grid {
        grid-template-columns: 1fr;
      }
      .right-grid {
        grid-template-columns: 1fr 1fr;
      }
    }
    @media (max-width: 480px) {
      .left-grid, .right-grid {
        grid-template-columns: 1fr;
      }
      .button, .left-button {
        width: 100%;
        height: auto;
        padding: 20px;
      }
      .button i {
        font-size: 36px;
      }
      .button-text {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <div class="main-container">
    <div class="unified-container">
      <!-- HEADER: Zeit & Ticker -->
      <div class="header">
        <div class="time-display">
          <p style="font-size: 1.5em; margin-bottom: -15px;">
            INTRANET FEUERWEHR WIENER NEUSTADT
          </p>
          <p id="currentDateTime">17. März 2025 um 20:29:57</p>
        </div>
        <!-- Ticker: Hier werden 5 kommende Termine angezeigt -->
        <div class="ticker-container">
          <div class="ticker" id="ticker">
            <!-- Inhalte werden dynamisch eingefügt -->
          </div>
        </div>
      </div>

      <!-- BUTTON-GRID -->
      <div class="button-grid-container">
        <!-- Linke 2x2-Kacheln (groß) -->
        <div class="left-grid">
          <!-- 1) Einsatzbericht -->
          <a href="Einsatzbericht.html" class="left-button">
            <i class="fas fa-exclamation-triangle"></i>
            <div class="button-text">Einsatzbericht</div>
          </a>
          <!-- 2) Übungsbericht -->
          <a href="Uebungsbericht.html" class="left-button">
            <i class="fas fa-clipboard-check"></i>
            <div class="button-text">Übungsbericht</div>
          </a>
          <!-- 3) Tätigkeitsbericht -->
          <a href="Teatigkeitsbercht.html" class="left-button">
            <i class="fas fa-file-alt"></i>
            <div class="button-text">Tätigkeitsbericht</div>
          </a>
          <!-- 4) Fahrtenbuch (ausgegraut/nicht klickbar) -->
          <a href="fahrenbuch.html" class="left-button disabled">
            <i class="fas fa-car"></i>
            <div class="button-text">Fahrtenbuch</div>
          </a>
        </div>

        <!-- Rechte 3x3-Kacheln (klein) -->
        <div class="right-grid">
          <!-- 1) Kommando -->
          <a href="https://beispiel2.com" class="button">
            <i class="fas fa-shield-alt"></i>
            <div class="button-text">Kommando</div>
          </a>
          <!-- 2) Chargen -->
          <a href="https://beispiel3.com" class="button">
            <i class="fas fa-users"></i>
            <div class="button-text">Chargen</div>
          </a>
          <!-- 3) Ausbildung -->
          <a href="https://beispiel4.com" class="button">
            <i class="fa-regular fa-clipboard"></i>
            <div class="button-text">Ausbildung</div>
          </a>
          <!-- 4) Samples -->
          <a href="https://beispiel6.com" class="button">
            <i class="fas fa-comments"></i>
            <div class="button-text">Samples</div>
          </a>
          <!-- 5) Kontakt -->
          <a href="Kontakt.html" class="button">
            <i class="fa-regular fa-address-card"></i>
            <div class="button-text">Kontakt</div>
          </a>
          <!-- 6) Placeholder -->
          <div class="button placeholder">
            <i class="fas fa-ban"></i>
            <div class="button-text">Platzhalter</div>
          </div>
          <!-- 7) Placeholder -->
          <div class="button placeholder">
            <i class="fas fa-ban"></i>
            <div class="button-text">Platzhalter</div>
          </div>
          <!-- 8) Placeholder -->
          <div class="button placeholder">
            <i class="fas fa-ban"></i>
            <div class="button-text">Platzhalter</div>
          </div>
          <!-- 9) Placeholder -->
          <div class="button placeholder">
            <i class="fas fa-ban"></i>
            <div class="button-text">Platzhalter</div>
          </div>
        </div>
      </div>

      <!-- LETZTE 5 EINSATZBERICHTE -->
      <div class="einsatzberichte-container">
        <h1>Letzte 5 Einsatzberichte</h1>
        <table id="reportTable">
          <thead>
            <tr>
              <th>Berichtnummer</th>
              <th>Datum</th>
              <th>Stichwort</th>
              <th>Art des Einsatzes</th>
            </tr>
          </thead>
          <tbody>
            <!-- Einträge werden hier dynamisch eingefügt -->
          </tbody>
        </table>
      </div>

      <!-- KALENDER (DARK MODE) -->
      <div class="calendar-container">
        <!-- Kopfzeile -->
        <div id="calendarHeader" class="calendar-header-bar">
          <div class="calendar-header-left">
            <button class="calendar-btn" id="todayBtn">Heute</button>
            <div class="calendar-nav-arrows">
              <button id="prevMonthBtn">&#10094;</button>
              <button id="nextMonthBtn">&#10095;</button>
            </div>
            <div class="calendar-month-year" id="monthYearLabel"></div>
          </div>
          <div class="calendar-header-right">
            <button class="calendar-btn">Monat</button>
          </div>
        </div>
        <!-- Wochentage -->
        <div class="weekdays" id="weekdaysRow"></div>
        <!-- Tages-Grid -->
        <div class="days" id="daysGrid"></div>
      </div>
    </div>
  </div>

  <!-- SCRIPTS -->
  <script>
    /* ==========================================
       1) UHRZEIT / DATUM AKTUALISIEREN
       ========================================== */
    function updateDateTime() {
      const dateTimeElement = document.getElementById("currentDateTime");
      const now = new Date();
      const options = {
        year: "numeric",
        month: "long",
        day: "numeric",
        hour: "2-digit",
        minute: "2-digit",
        second: "2-digit",
      };
      dateTimeElement.textContent = now.toLocaleDateString("de-DE", options);
    }
    setInterval(updateDateTime, 1000);
    updateDateTime();

    /* ==========================================
       2) LETZTE 5 EINSATZBERICHTE
       ========================================== */
    const csvUrlEinsatz = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQJhQbJMxG8s7oSw__c97Z55koBtE2Dlgc0OYR8idpZtdTq3o9g7LbmyEve3KPNkV5yaRZGIHVjJPkk/pub?gid=1016482411&single=true&output=csv";
    Papa.parse(csvUrlEinsatz, {
      download: true,
      header: true,
      skipEmptyLines: true,
      complete: function(results) {
        const data = results.data;
        if (data.length === 0) {
          console.warn("Keine Daten für Einsatzberichte gefunden.");
          return;
        }
        const lastFive = data.slice(-5);
        const tbody = document.querySelector("#reportTable tbody");
        lastFive.forEach((row) => {
          const berichtnummer = row["Einsatzberichtnummer"] || "";
          const datum = row["Datum (Alarmierung)"] || "";
          const stichwort = row["Einsatzstichwort"] || "";
          const code = stichwort.trim().charAt(0).toUpperCase();
          let artEinsatz = "";
          switch(code) {
            case "B":
              artEinsatz = "Brandeinsatz";
              break;
            case "T":
              artEinsatz = "Technischer Einsatz";
              break;
            case "S":
              artEinsatz = "Schadstoff Einsatz";
              break;
            default:
              artEinsatz = "Sonstiger Einsatz";
          }
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${berichtnummer}</td>
            <td>${datum}</td>
            <td>${stichwort}</td>
            <td>${artEinsatz}</td>
          `;
          tbody.appendChild(tr);
        });
      },
      error: function(err) {
        console.error("Fehler beim Laden der CSV für Einsatzberichte:", err);
      }
    });

    /* ==========================================
       3) KALENDER & TICKER – CSV LADEN & RENDERN
       ========================================== */
    // Kalender-CSV (Spalten: "Event Titel", "Startzeit" (TT.MM.YYYY), "Endzeit", "Beschreibung")
    const calendarCSV = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQJhQbJMxG8s7oSw__c97Z55koBtE2Dlgc0OYR8idpZtdTq3o9g7LbmyEve3KPNkV5yaRZGIHVjJPkk/pub?gid=820363757&single=true&output=csv";
    let calendarEvents = [];
    let currentDate = new Date();

    // DOM-Elemente
    const weekdaysRow = document.getElementById("weekdaysRow");
    const daysGrid = document.getElementById("daysGrid");
    const monthYearLabel = document.getElementById("monthYearLabel");
    const todayBtn = document.getElementById("todayBtn");
    const prevMonthBtn = document.getElementById("prevMonthBtn");
    const nextMonthBtn = document.getElementById("nextMonthBtn");
    const tickerElement = document.getElementById("ticker");

    // Deutsche Wochentage & Monatsnamen
    const weekdays = ["Mo", "Di", "Mi", "Do", "Fr", "Sa", "So"];
    const monthNames = [
      "Januar", "Februar", "März", "April", "Mai", "Juni",
      "Juli", "August", "September", "Oktober", "November", "Dezember"
    ];

    // 3.1) Kalender-CSV laden
    function loadCalendarCSV() {
      Papa.parse(calendarCSV, {
        download: true,
        header: true,
        skipEmptyLines: true,
        complete: function(results) {
          const data = results.data;
          calendarEvents = data.map(row => {
            const isoStart = convertToISODate(row["Startzeit"]);
            return {
              title: (row["Event Titel"] || "").trim(),
              startISO: isoStart,
              startRaw: (row["Startzeit"] || "").trim(),
              endRaw: (row["Endzeit"] || "").trim(),
              description: (row["Beschreibung"] || "").trim()
            };
          });
          renderCalendar(currentDate);
          updateTickerWithNextFive();
        },
        error: function(err) {
          console.error("Fehler beim Laden der CSV (Kalender):", err);
        }
      });
    }

    // 3.2) Hilfsfunktion: TT.MM.YYYY -> YYYY-MM-DD
    function convertToISODate(dmy) {
      if (!dmy) return "";
      const [day, month, year] = dmy.split(".");
      return `${year}-${String(month).padStart(2, "0")}-${String(day).padStart(2, "0")}`;
    }

    // 3.3) Wochentage rendern
    function renderWeekdays() {
      weekdaysRow.innerHTML = "";
      weekdays.forEach(day => {
        const div = document.createElement("div");
        div.textContent = day;
        weekdaysRow.appendChild(div);
      });
    }

    // 3.4) Filter: Events an einem Tag
    function getEventsForDate(isoDate) {
      return calendarEvents.filter(ev => ev.startISO === isoDate);
    }

    // 3.5) Kalender rendern
    function renderCalendar(date) {
      daysGrid.innerHTML = "";
      const year = date.getFullYear();
      const month = date.getMonth();
      monthYearLabel.textContent = `${monthNames[month]} ${year}`;

      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);
      const daysInMonth = lastDay.getDate();

      let startDay = firstDay.getDay();
      if (startDay === 0) startDay = 7;
      const emptyCells = startDay - 1;

      // Leere Zellen vor dem 1. Tag
      for (let i = 0; i < emptyCells; i++) {
        const cell = document.createElement("div");
        cell.classList.add("day-cell", "empty");
        daysGrid.appendChild(cell);
      }

      // Tage des Monats
      for (let day = 1; day <= daysInMonth; day++) {
        const cell = document.createElement("div");
        cell.classList.add("day-cell");

        const dayDiv = document.createElement("div");
        dayDiv.classList.add("day-number");
        dayDiv.textContent = day;
        cell.appendChild(dayDiv);

        const isoDate = `${year}-${String(month+1).padStart(2, "0")}-${String(day).padStart(2, "0")}`;
        const today = new Date();
        if (
          day === today.getDate() &&
          month === today.getMonth() &&
          year === today.getFullYear()
        ) {
          cell.classList.add("today-highlight");
        }

        // Events für diesen Tag
        const events = getEventsForDate(isoDate);
        events.forEach(ev => {
          const eventDiv = document.createElement("div");
          eventDiv.classList.add("event");
          eventDiv.textContent = ev.title;
          eventDiv.addEventListener("click", (e) => {
            const existingPopup = cell.querySelector(".event-popup");
            if (existingPopup) {
              existingPopup.remove();
            } else {
              openEventPopup(ev, cell);
            }
            e.stopPropagation();
          });
          cell.appendChild(eventDiv);
        });

        daysGrid.appendChild(cell);
      }

      // Bereits offene Popups schließen
      const openPopups = document.querySelectorAll(".event-popup");
      openPopups.forEach(popup => popup.remove());
    }

    // 3.6) Kalender-Navigation
    prevMonthBtn.addEventListener("click", () => {
      let year = currentDate.getFullYear();
      let month = currentDate.getMonth();
      month--;
      if (month < 0) { month = 11; year--; }
      currentDate = new Date(year, month, 1);
      renderCalendar(currentDate);
    });
    nextMonthBtn.addEventListener("click", () => {
      let year = currentDate.getFullYear();
      let month = currentDate.getMonth();
      month++;
      if (month > 11) { month = 0; year++; }
      currentDate = new Date(year, month, 1);
      renderCalendar(currentDate);
    });
    todayBtn.addEventListener("click", () => {
      const now = new Date();
      currentDate = new Date(now.getFullYear(), now.getMonth(), 1);
      renderCalendar(currentDate);
    });

    // 3.7) Ticker: Zeige 5 kommende Events
    function updateTickerWithNextFive() {
      const now = new Date();
      const upcoming = calendarEvents
        .filter(ev => {
          if (!ev.startISO) return false;
          const d = new Date(ev.startISO);
          return d >= now;
        })
        .sort((a, b) => new Date(a.startISO) - new Date(b.startISO))
        .slice(0, 5);

      if (upcoming.length === 0) {
        tickerElement.innerHTML = `<div class="ticker-item"><strong>Keine kommenden Termine.</strong></div>`;
        return;
      }
      tickerElement.innerHTML = upcoming.map(ev => {
        return `
          <div class="ticker-item">
            <i class="fas fa-calendar-alt"></i>
            <strong>${ev.title}:</strong> ${ev.startRaw}
          </div>
        `;
      }).join("");
    }

    // 3.8) Popup ("Pin") in der Zelle für Event-Details
    function openEventPopup(ev, dayCell) {
      const popup = document.createElement("div");
      popup.classList.add("event-popup");

      const closeBtn = document.createElement("span");
      closeBtn.classList.add("close-popup");
      closeBtn.innerHTML = "&times;";
      closeBtn.addEventListener("click", (e) => {
        popup.remove();
        e.stopPropagation();
      });
      popup.appendChild(closeBtn);

      const titleP = document.createElement("p");
      titleP.innerHTML = `<strong>${ev.title}</strong>`;
      popup.appendChild(titleP);

      const dateP = document.createElement("p");
      let dates = `Start: ${ev.startRaw}`;
      if (ev.endRaw) { dates += ` &ndash; Ende: ${ev.endRaw}`; }
      dateP.innerHTML = dates;
      popup.appendChild(dateP);

      if (ev.description) {
        const descP = document.createElement("p");
        descP.textContent = ev.description;
        popup.appendChild(descP);
      }
      dayCell.appendChild(popup);
    }

    // Init: Wochentage rendern & CSV laden
    function initCalendar() {
      renderWeekdays();
      loadCalendarCSV();
    }
    initCalendar();
  </script>

<footer class="footer">
  <p>Intranet by dieserkleinmann</p>
</footer>

</body>
</html>
